<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Submit Question</title>
    <link href="styles.css" rel="stylesheet">
</head>

<body>
    <h1>Submit a Question</h1>
    <form id="submitForm" onsubmit="submitQuestion(event)">
        <label for="questionText">Question:</label>
        <input id="questionText" type="text" required>
        <label for="answers">Answers (Correct first):</label>
        <input id="answer1" type="text" required>
        <input id="answer2" type="text" required>
        <input id="answer3" type="text" required>
        <input id="answer4" type="text" required>
        <label for="category">Category:</label>
        <select id="category"></select>
        <label for="newCategory">New Category:</label>
        <input id="newCategory" type="text">
        <button type="submit">Submit</button>
    </form>

<script>
    function fetchCategories()
    {
        fetch('http://localhost:4000/categories')
            .then(response => response.json())
            .then(data =>
            {
                const categoryDropdown = document.getElementById('category');
                categoryDropdown.innerHTML = ''; // Clear existing options

                data.forEach(category =>
                {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categoryDropdown.appendChild(option);
                });
            })
            .catch(error => console.error('Error fetching categories:', error));
    }

    function submitQuestion(event)
    {
        event.preventDefault();

        const question = document.getElementById('questionText').value;
        const answers = [
            document.getElementById('answer1').value,
            document.getElementById('answer2').value,
            document.getElementById('answer3').value,
            document.getElementById('answer4').value
        ];
        const correctAnswer = document.getElementById('answer1').value; // Assume the first input is the correct answer
        const category = document.getElementById('category').value;
        const newCategory = document.getElementById('newCategory').value;

        fetch('http://localhost:4000/submit', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ question, answers, correctAnswer, category, newCategory })
        })
            .then(response => response.json())
            .then(data =>
            {
                alert(data.message || 'Question submitted successfully!');
                document.getElementById('submitForm').reset(); // Clear the form after submission
            })
            .catch(error => console.error('Error submitting question:', error));
    }

    // Populate categories on page load
    window.onload = fetchCategories;
</script>
</body>

</html>